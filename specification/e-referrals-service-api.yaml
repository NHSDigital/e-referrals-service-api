# This is an OpenAPI Specification (https://swagger.io/specification/)
# for the e-Referral Service API
# owned by NHS Digital (https://digital.nhs.uk/)
openapi: 3.0.0
x-nhsd-api-platform:
  meta:
    service_name: e-referrals-service-api
    short_service_name: ers
    service_base_path: referrals
    product_display_name: e-Referrals-Service
    product_description: 'The NHS e-RS vision is to enable local innovation and adoption of paperless referrals. To support this vision NHS Digital have created a set of APIs which provide a well-defined, simple to use data interface to the NHS e-Referral Service (e-RS). See https://developer.nhs.uk/apis/e-Referrals/index.html'
    pipeline_name_prefix: E-Referrals-Service
info:
  version: 0.0.1
  title: e-Referrals Service
  description: |
    ## Overview
    A key aspect of the NHS e-RS vision is to enable local innovation and adoption of paperless referrals. To support this vision NHS Digital have created a set of APIs which provide a well-defined, simple to use data interface to the NHS e-Referral Service (e-RS).

    You can:

    You cannot currently use this API to:

    You can read and update the following data:

    ### Access modes

    Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer nec odio. Praesent libero. 
    Sed cursus ante dapibus diam. Sed nisi. Nulla quis sem at nibh elementum imperdiet. 
    Duis sagittis ipsum. Praesent mauris. Fusce nec tellus sed augue semper porta. 
    Mauris massa. Vestibulum lacinia arcu eget nulla. Class aptent taciti sociosqu ad litora torquent per 
    conubia nostra, per inceptos himenaeos. 


    ## Who can use this API

    Curabitur sodales ligula in libero. Sed dignissim lacinia nunc. Curabitur tortor. Pellentesque nibh. 
    Aenean quam. In scelerisque sem at dolor. Maecenas mattis. Sed convallis tristique sem. 
    Proin ut ligula vel nunc egestas porttitor. Morbi lectus risus, iaculis vel, suscipit quis, 
    luctus non, massa. Fusce ac turpis quis ligula lacinia aliquet. Mauris ipsum. 


    ## Related APIs

    Nulla metus metus, ullamcorper vel, tincidunt sed, euismod in, nibh. Quisque volutpat condimentum velit. 
    Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. 
    Nam nec ante. Sed lacinia, urna non tincidunt mattis, tortor neque adipiscing diam, 
    a cursus ipsum ante quis turpis. Nulla facilisi. Ut fringilla. Suspendisse potenti. 
    Nunc feugiat mi a tellus consequat imperdiet. Vestibulum sapien. Proin quam. 


    ## API status and roadmap

    Etiam ultrices. Suspendisse in justo eu magna luctus suscipit. Sed lectus. Integer euismod lacus luctus magna. 
    Quisque cursus, metus vitae pharetra auctor, sem massa mattis sem, at interdum magna augue eget diam. Vestibulum 
    ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Morbi lacinia molestie dui. 
    Praesent blandit dolor. Sed non quam. In vel mi sit amet augue congue elementum. Morbi in ipsum sit amet pede 
    facilisis laoreet. Donec lacus nunc, viverra nec, blandit vel, egestas et, augue. Vestibulum tincidunt malesuada tellus.

    ### Healthcare worker access

    Ut ultrices ultrices enim. Curabitur sit amet mauris. Morbi in dui quis est pulvinar ullamcorper. 
    Nulla facilisi. Integer lacinia sollicitudin massa. Cras metus. Sed aliquet risus a tortor. 
    Integer id quam. Morbi mi. Quisque nisl felis, venenatis tristique, dignissim in, ultrices sit amet, 
    augue. Proin sodales libero eget ante. Nulla quam. 

    ### Citizen access

    Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer nec odio. Praesent libero. 
    Sed cursus ante dapibus diam. Sed nisi. Nulla quis sem at nibh elementum imperdiet. 
    Duis sagittis ipsum. Praesent mauris. Fusce nec tellus sed augue semper porta. 
    Mauris massa. Vestibulum lacinia arcu eget nulla. Class aptent taciti sociosqu ad litora torquent per 
    conubia nostra, per inceptos himenaeos. 

    ### Roadmap

    Nulla metus metus, ullamcorper vel, tincidunt sed, euismod in, nibh. Quisque volutpat condimentum velit. 
    Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. 
    Nam nec ante. Sed lacinia, urna non tincidunt mattis, tortor neque adipiscing diam, 
    a cursus ipsum ante quis turpis. Nulla facilisi. Ut fringilla. Suspendisse potenti. 
    Nunc feugiat mi a tellus consequat imperdiet. Vestibulum sapien. Proin quam. 


    ## Technology

    Nulla metus metus, ullamcorper vel, tincidunt sed, euismod in, nibh. Quisque volutpat condimentum velit. 
    Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. 
    Nam nec ante. Sed lacinia, urna non tincidunt mattis, tortor neque adipiscing diam, 
    a cursus ipsum ante quis turpis. Nulla facilisi. Ut fringilla. Suspendisse potenti. 
    Nunc feugiat mi a tellus consequat imperdiet. Vestibulum sapien. Proin quam.

    ## Network access

    Etiam ultrices. Suspendisse in justo eu magna luctus suscipit. Sed lectus. Integer euismod lacus luctus magna. 
    Quisque cursus, metus vitae pharetra auctor, sem massa mattis sem, at interdum magna augue eget diam. Vestibulum 
    ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Morbi lacinia molestie dui. 
    Praesent blandit dolor. Sed non quam. In vel mi sit amet augue congue elementum. Morbi in ipsum sit amet pede 
    facilisis laoreet. Donec lacus nunc, viverra nec, blandit vel, egestas et, augue. Vestibulum tincidunt malesuada tellus.

    ## Security and authorisation

    Ut ultrices ultrices enim. Curabitur sit amet mauris. Morbi in dui quis est pulvinar ullamcorper. 
    Nulla facilisi. Integer lacinia sollicitudin massa. Cras metus. Sed aliquet risus a tortor. 
    Integer id quam. Morbi mi. Quisque nisl felis, venenatis tristique, dignissim in, ultrices sit amet, 
    augue. Proin sodales libero eget ante. Nulla quam. 

    ## Environments and testing

    | Environment       | Base URL                                                               |
    | ----------------- | ---------------------------------------------------------------------- |
    | Sandbox           | `https://sandbox.api.service.nhs.uk/referrals` |
    | Integration test  | `https://int.api.service.nhs.uk/referrals` |
    | Production        | `https://api.service.nhs.uk/referrals` |

    ### Sandbox testing
    Our [sandbox environment](https://digital.nhs.uk/developer/guides-and-documentation/testing#sandbox-testing):
    * is for early developer testing
    * only covers a limited set of scenarios
    * is stateless, so does not actually persist any updates
    * is open access, so does not allow you to test authorisation

    Try out the sandbox using our 'Try this API' feature, see the documentation for each endpoint. Sandbox will only respond to 
    input matching one of the examples specified for each endpoint.

    ### Integration testing

    Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer nec odio. Praesent libero. 
    Sed cursus ante dapibus diam. Sed nisi. Nulla quis sem at nibh elementum imperdiet. 
    Duis sagittis ipsum. Praesent mauris. Fusce nec tellus sed augue semper porta. 
    Mauris massa. Vestibulum lacinia arcu eget nulla. Class aptent taciti sociosqu ad litora torquent per 
    conubia nostra, per inceptos himenaeos. 

    ### Production smoke testing

    Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer nec odio. Praesent libero. 
    Sed cursus ante dapibus diam. Sed nisi. Nulla quis sem at nibh elementum imperdiet. 
    Duis sagittis ipsum. Praesent mauris. Fusce nec tellus sed augue semper porta. 
    Mauris massa. Vestibulum lacinia arcu eget nulla. Class aptent taciti sociosqu ad litora torquent per 
    conubia nostra, per inceptos himenaeos. 

    ## Onboarding

    Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer nec odio. Praesent libero. 
    Sed cursus ante dapibus diam. Sed nisi. Nulla quis sem at nibh elementum imperdiet. 
    Duis sagittis ipsum. Praesent mauris. Fusce nec tellus sed augue semper porta. 
    Mauris massa. Vestibulum lacinia arcu eget nulla. Class aptent taciti sociosqu ad litora torquent per 
    conubia nostra, per inceptos himenaeos. 


  contact:
    url: 'https://digital.nhs.uk/developer/help-and-support'
    email: api.management@nhs.net
  license:
    name: MIT
servers:
  - url: 'https://internal-dev-sandbox.api.service.nhs.uk/referrals-pr-13'
    description: Pr Sandbox environment.
  - url: 'https://sandbox.api.service.nhs.uk/referrals'
    description: Sandbox environment.
  - url: 'https://int.api.service.nhs.uk/referrals'
    description: Integration test environment.
  - url: 'https://api.service.nhs.uk/referrals'
    description: 'Production environment.'
paths:
  /STU3/v1/ReferralRequest/$ers.createReferral:
    post:
      security:
        - bearerAuth: []
      description: |
        ## Overview
        Use this endpoint to create a referral by choosing a shortlist of bookable services.

        ## Pre-requisites
        In order to use this endpoint you must be an authenticated e-RS user and use one of the following e-RS roles:
          - `REFERRING_CLINICIAN`
          - `REFERRING_CLINICIAN_ADMIN`
        
        You need to have identified a `patient`, for example via [[HYPERLINK_PDS]].

        You need to have found services that meet the referral needs of a patient using [[HYPERLINK_A010]].

        ## Use case
        As an authenticated user

        I need to create a shortlist of bookable services

        So I can initiate my patients referral pathway, allowing the patient to book into one of the shortlisted services.

        ## Related endpoints
        You can book an appointment for the patient by using [[HYPERLINK_A015]] and [[HYPERLINK_A016]].

        For the referral to be processed by the service provider, you must ensure appropriate referral letter information has been added to the referral. You can add/manage referrer letter information by using [A012 - Maintain referral letter](https://developer.nhs.uk/apis/e-Referrals/explore_endpoint_a012.html).

        You can check to see what referral letter information has already been added to a referral by using [[HYPERLINK_A005]], [[HYPERLINK_A007]], and [[HYPERLINK_A006]] endpoints where necessary.

      summary: A011 - Create referral
      operationId: a011-create-referral
      parameters:
        - $ref: 'components/schemas/headers/request/BearerAuthorization.yaml'
        - $ref: 'components/schemas/headers/request/OdsCode.yaml'
        - $ref: 'components/schemas/headers/request/BusinessFunction.yaml'
        - $ref: 'components/schemas/headers/request/CorrelationID.yaml'
      requestBody:
        required: true
        content:
          application/fhir+json:
            schema:
              $ref: 'components/schemas/CreateReferralParameters.yaml'
            examples:
              rc-minimum-request-body:
                summary: Referring Clinician - minimum request body
                value:
                  $ref: 'components/examples/createReferral/requests/MinimalRequest.json'
              rc-request-body-multi-service-shortlist:
                summary: Referring Clinician - request body using multi-service shortlist
                value:
                  $ref: 'components/examples/createReferral/requests/RequestTwentyServices.json'
              create-referral-parameters-twenty-services:
                summary: Referring Clinician Admin - minimum request body
                value:
                  $ref: 'components/examples/createReferral/requests/MinimalRequestWithReferringClinician.json'
      responses:
        '201':
          $ref: 'components/schemas/responses/createReferral/201Response.yaml'
        '400':
          $ref: 'components/schemas/responses/BadRequest.yaml'
        '401':
          $ref: 'components/schemas/responses/Unauthorized.yaml'
        '403':
          $ref: 'components/schemas/responses/Forbidden.yaml'
        '422':
          $ref: 'components/schemas/responses/CreateReferralErrorOutcome.yaml'
        '500':
          $ref: 'components/schemas/responses/InternalServerError.yaml'
  /STU3/v1/ReferralRequest/$ers.createReferralAndSendForTriage:
    post:
      security:
        - bearerAuth: []
      description: |
        ## Overview
        Use this endpoint to refer the patient directly to a triage service.

        Please note: this endpoint cannot be used to shortlist bookable services. In order to shortlist bookable services please use [[HYPERLINK_A011]].
        
        ## Pre-requisites
        In order to use this endpoint you must be an authenticated e-RS user and use one of the following e-RS roles:
          - `REFERRING_CLINICIAN`
          - `REFERRING_CLINICIAN_ADMIN`

        You need to have identified a `patient`, for example via [[HYPERLINK_PDS]].

        You need to have found services that meet the referral needs of a patient using [[HYPERLINK_A010]].

        ## Use case
        As an authenticated e-RS user

        I need to send the patient's referral to a triage service for assessment

        So that I can put the patient on the appropriate clinical pathway for the chosen service provider.

        ## Related endpoints

        For the referral to be processed by the service provider, you must ensure appropriate referral letter information has been added to the referral. You can add/manage referrer letter information by using [[HYPERLINK_A012]].

        You can check to see what referral letter information has already been added to a referral by using [[HYPERLINK_A005]], [[HYPERLINK_A007]], and [[HYPERLINK_A006]] endpoints where necessary.

      summary: A021 - Create referral and send for triage
      operationId: a021-create-referral-request-and-send-for-triage
      parameters:
        - $ref: 'components/schemas/headers/request/BearerAuthorization.yaml'
        - $ref: 'components/schemas/headers/request/OdsCode.yaml'
        - $ref: 'components/schemas/headers/request/BusinessFunction.yaml'
        - $ref: 'components/schemas/headers/request/CorrelationID.yaml'
      requestBody:
        required: true
        content:
          application/fhir+json:
            schema:
              $ref: 'components/schemas/CreateReferralAndSendForTriageParameters.yaml'
            examples:
              parameters:
                summary: Referring Clinician creates referral to a Triage service
                value:
                  $ref: 'components/examples/createReferralAndSendForTriage/requests/Parameters.json'
              parameters-with-named-clinician:
                summary: Referring Clinician Admin minimum call
                value:
                  $ref: 'components/examples/createReferralAndSendForTriage/requests/ParametersWithNamedClinician.json'
      responses:
        '201':
          $ref: 'components/schemas/responses/createReferralAndSendForTriage/201Response.yaml'
        '400':
          $ref: 'components/schemas/responses/BadRequest.yaml'
        '401':
          $ref: 'components/schemas/responses/Unauthorized.yaml'
        '403':
          $ref: 'components/schemas/responses/Forbidden.yaml'
        '422':
          $ref: 'components/schemas/responses/CreateReferralErrorOutcome.yaml'
        '500':
          $ref: 'components/schemas/responses/InternalServerError.yaml'
  /STU3/v1/HealthcareService/$ers.searchHealthcareServicesForPatient:
    post:
      security:
        - bearerAuth: []
      description: |
        ## Overview
        Use this endpoint to find services that meet the referral needs of a patient.

        ## Pre-requisites
        In order to use this endpoint you must be an authenticated e-RS user and use one of the following e-RS roles:
          - `REFERRING_CLINICIAN`
          - `REFERRING_CLINICIAN_ADMIN`
        
        You need to have identified a `patient`, for example via [[HYPERLINK_PDS]].

        ## Use case
        As an authenticated user

        I need to find services I can refer the patient to

        So that I can offer the patient appropriate services that meet their referral needs

        ## Related endpoints
        Once you have identified appropriate services for the patient you can either:
          - create a referral by choosing a shortlist of bookable services using [[HYPERLINK_A011]], or
          - refer the patient directly to a triage service using [[HYPERLINK_A021]]
      summary: A010 - Patient service search
      operationId: a010-patient-service-search
      parameters:
        - $ref: 'components/schemas/headers/request/BearerAuthorization.yaml'
        - $ref: 'components/schemas/headers/request/OdsCode.yaml'
        - $ref: 'components/schemas/headers/request/BusinessFunction.yaml'
        - $ref: 'components/schemas/headers/request/CorrelationID.yaml'
      requestBody:
        required: true
        content:
          application/fhir+json:
            schema:
              $ref: 'components/schemas/PatientServiceSearchParameters.yaml'
            examples:
              rc-minimal:
                summary: Referring Clinician minimal search
                value:
                  $ref: 'components/examples/patientServiceSearch/requests/RcMinimal.json'
              rc-search-by-clinical-term:
                summary: Referring Clinician search by clinical term
                value:
                  $ref: 'components/examples/patientServiceSearch/requests/RcSearchByClinicalTerm.json'
              rc-search-by-named-clinician:
                summary: Referring Clinician search by named clinician
                value:
                  $ref: 'components/examples/patientServiceSearch/requests/RcSearchByNamedClinician.json'
              rca-with-iwt:
                summary: Referring Clinician Admin search
                value:
                  $ref: 'components/examples/patientServiceSearch/requests/RcaWithIWT.json'
      responses:
        '200':
          $ref: 'components/schemas/responses/patientServiceSearch/200Response.yaml'
        '400':
          $ref: 'components/schemas/responses/BadRequest.yaml'
        '401':
          $ref: 'components/schemas/responses/Unauthorized.yaml'
        '403':
          $ref: 'components/schemas/responses/Forbidden.yaml'
        '422':
          $ref: 'components/schemas/responses/patientServiceSearch/ErrorOutcome.yaml'
        '500':
          $ref: 'components/schemas/responses/InternalServerError.yaml'
  /STU3/v1/CodeSystem/{codeSystemType}:
    parameters:
      - $ref: 'components/schemas/path/CodeSystemType.yaml'
    get:
      security:
        - bearerAuth: []
      description: |
        ## Overview
        Use this endpoint to retrieve a list of reference data codes along with the user-friendly display values used in the e-RS Professional Application.
        
        ## Pre-requisites
        In order to use this endpoint you must be an authenticated e-RS user.
        
        ## Use case
        As an authenticated e-RS user
        I need to retrieve e-RS reference data
        So I can use it with other endpoints or display the reference data in a user-friendly format to my users.
        
        ## Related endpoints
        Reference data may be needed for other endpoints, for example when including Specialty and Clinic Type reference data to:
        - find services that meet the referral needs of a patient using [[HYPERLINK_A010]], and
        - create a referral using [[HYPERLINK_A011]] or [[HYPERLINK_A021]]
        
        You may also wish to present the user-friendly names for the reference data, for example when viewing the referral using [[HYPERLINK_A005]]
        
        ## Sandbox test scenarios
        You can test the following scenarios in our sandbox environment
        
        | Scenario                                                | Request                                            | Response                        |
        | ------------------------------------------------------- | -------------------------------------------------- | ------------------------------- |
        | Retrieve speciality reference data                      | `codeSystemType`=`SPECIALTY`                       | Specialty details               |
        | Retrieve clinic type reference data                     | `codeSystemType`=`CLINIC-TYPE`                     | Clinic type details             |
        | Retrieve appointment cancellation reason reference data | `codeSystemType`=`APPOINTMENT-CANCELLATION-REASON` | Appointment reason type details |
        
        ## This endpoint can be accessed using the following [[HYPERLINK_ERS_BUS_FUNCTIONS]]
        - REFERRING_CLINICIAN
        - REFERRING_CLINICIAN_ADMIN
        - SERVICE_PROVIDER_CLINICIAN
      summary: A004 - Retrieve reference data
      operationId: a004-retrieve-reference-data
      parameters:
        - $ref: 'components/schemas/headers/request/BearerAuthorization.yaml'
        - $ref: 'components/schemas/headers/request/OdsCode.yaml'
        - $ref: 'components/schemas/headers/request/BusinessFunction.yaml'
        - $ref: 'components/schemas/headers/request/CorrelationID.yaml'
      responses:
        '200':
          $ref: 'components/schemas/responses/getCodeSystem/200Response.yaml'
        '400':
          $ref: 'components/schemas/responses/BadRequest.yaml'
        '401':
          $ref: 'components/schemas/responses/Unauthorized.yaml'
        '403':
          $ref: 'components/schemas/responses/Forbidden.yaml'
        '404':
          $ref: 'components/schemas/responses/NotFound.yaml'
        '500':
          $ref: 'components/schemas/responses/InternalServerError.yaml'
  /STU3/v1/Slot:
    get:
      description: |
        ## Overview
        Use this endpoint to retrieve available appointment slots for a service.

        ## Pre-requisites
        In order to use this endpoint you must be an authenticated e-RS user and use one of the following e-RS roles:
          - `REFERRING_CLINICIAN`
          - `REFERRING_CLINICIAN_ADMIN`

        You need to have identified a directly bookable `service` that is on the current referral shortlist. You can do this by using [[HYPERLINK_A005]].

        ## Use case

        As an authenticated e-RS user

        I need to retrieve a list of available appointment slots for a service

        So that I can offer them to the patient for booking.

        ## Important note
        You need to provide the 'commissioning rule organisation' when calling A015 - Retrieve appointment slots to ensure only suitable slots are returned. You can obtain the 'commissioning rule organisation' from [[HYPERLINK_A005]].
        
        ## Related endpoints

        You can book an appointment to an available slot using [[HYPERLINK_A016]].

        You can defer booking to a directly bookable service using [[HYPERLINK_A016]] but only in the following circumstances:
          - when the service has no available slots
          - when trying to book an appointment into a service, the slot advertised is no longer available
          - when trying to book an appointment into a service, no response is received within message timeout period (currently 2 minutes)

        ## Sandbox test scenarios

        You can test the following scenarios in our sandbox environment:

        | Scenario                               | Request Query Parameters                                                                                                                                          | Response                                                                |
        | -------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------- |
        | Minimum slot search                    | `schedule.actor:HealthcareService`=`12000`, `appointmentType`=`ROUTINE`, `_count`=`20`, `status`=`free`, `page`=`1`                                               | Illustrates minimum usage/parameters with concise, minimal response.    |
        | Empty slot search response             | `schedule.actor:HealthcareService`=`10000`, `appointmentType`=`ROUTINE`, `_count`=`20`, `status`=`free`, `page`=`1`                                               | Illustrates how a 'no slots' response appears.                          |
        | Multipage slot search (page 1)         | `schedule.actor:HealthcareService`=`11000`, `appointmentType`=`ROUTINE`, `_count`=`5`, `status`=`free`, `page`=`1`                                                | Illustrates first page of multi-page response.                          |
        | Multipage slot search (page 2)         | `schedule.actor:HealthcareService`=`11000`, `appointmentType`=`ROUTINE`, `_count`=`5`, `status`=`free`, `page`=`2`                                                | Illustrates second page of multi-page response.                         |
        | Multipage slot search (invalid page 5) | `schedule.actor:HealthcareService`=`11000`, `appointmentType`=`ROUTINE`, `_count`=`5`, `status`=`free`, `page`=`5`                                                | Illustrates error when page is outside of valid range.                  |
        | Multi schedule response                | `schedule.actor:HealthcareService`=`13000`, `appointmentType`=`ROUTINE`, `_count`=`5`, `status`=`free`, `page`=`1`                                                | Illustrates response when there is >1 Schedule: one Schedule is for slots with no associated clinician and the other does have an associated clinician. |
        | Slot clinician search                  | `schedule.actor:HealthcareService`=`14000`, `schedule.actor:Practitioner`=`921600556514`, `appointmentType`=`ROUTINE`, `_count`=`5`, `status`=`free`, `page`=`1`  | Illustrates search for clinician-specific slots                         |

      summary: A015 - Retrieve appointment slots
      operationId: a015-retrieve-appointment-slots
      parameters:
        - $ref: 'components/schemas/headers/request/BearerAuthorization.yaml'
        - $ref: 'components/schemas/headers/request/OdsCode.yaml'
        - $ref: 'components/schemas/headers/request/BusinessFunction.yaml'
        - $ref: 'components/schemas/headers/request/CorrelationID.yaml'
        - $ref: 'components/schemas/headers/request/ErsXapiCommRuleOrg.yaml'
        - $ref: 'components/schemas/queryParameters/ServiceId.yaml'
        - $ref: 'components/schemas/queryParameters/Priority.yaml'
        - $ref: 'components/schemas/queryParameters/Status.yaml'
        - $ref: 'components/schemas/queryParameters/PageSize.yaml'
        - $ref: 'components/schemas/queryParameters/PageNumber.yaml'
        - $ref: 'components/schemas/queryParameters/NamedClinician.yaml'
        - $ref: 'components/schemas/queryParameters/Include.yaml'
      responses:
        '200':
          $ref: 'components/schemas/responses/retrieveAppointmentSlots/200Response.yaml'
        '400':
          $ref: 'components/schemas/responses/retrieveAppointmentSlots/ErrorOutcome.yaml'
        '401':
          $ref: 'components/schemas/responses/Unauthorized.yaml'
        '403':
          $ref: 'components/schemas/responses/Forbidden.yaml'
        '500':
          $ref: 'components/schemas/responses/InternalServerError.yaml'
  /R4/v1/PractitionerRole:
    get:
      security:
        - bearerAuth: []
      description: |
        ## Overview
        
        Use this endpoint to retrieve a list of available e-RS roles (i.e. business functions) at each organisation where the user works.

        ## Pre-requisites

        In order to use this endpoint you must be an authenticated user

        ## Use case

        As an authenticated user

        I need to retrieve a list of authorised e-RS roles for organisations I work for

        So I can choose the appropriate role and organisation to work under when performing tasks.

        ## Related endpoints

        You can then use the e-RS roles to perform specific tasks using other e-RS endpoints.

      summary: A028 - Retrieve e-RS business functions
      operationId: a028-retrieve-business-functions
      parameters:
        - $ref: 'components/schemas/headers/request/BearerAuthorization.yaml'
      responses:
        '200':
          $ref: 'components/schemas/responses/retrieveBusinessFunctions/200Response.yaml'
        '401':
          $ref: 'components/schemas/responses/Unauthorized.yaml'
        '403':
          $ref: 'components/schemas/responses/Forbidden.yaml'
        '500':
          $ref: 'components/schemas/responses/InternalServerError.yaml'
  /STU3/v1/Binary:
    post:
      security:
        - bearerAuth: []
      description: |
        ## Overview
        
        Use this endpoint to upload a file containing clinical information to e-RS ready to be associated with a referral.

        ## Pre-requisites
        In order to use this endpoint you must be an authenticated e-RS user and use one of the following e-RS roles:
          - `REFERRING_CLINICIAN`
          - `REFERRING_CLINICIAN_ADMIN`
          - `SERVICE_PROVIDER_CLINICIAN`

        You can only upload file formats that are supported by e-RS. Currently, the supported file formats are:

        | File type          | File extension(s)           |
        | ------------------ | --------------------------- |
        | Plain Text         | `.txt`                      |
        | HTML Text          | `.html,` `.htm`             |
        | PDF                | `.pdf`                      |
        | XML Text           | `.xml`                      |
        | RTF Text           | `.rtf`, `.rtx`              |
        | Basic Audio        | `.au`                       |
        | MPEG audio layer 3 | `.mp3`                      |
        | PNG Image          | `.png`                      | 
        | GIF Image          | `.gif`                      |
        | JPEG Image         | `.jpg,` `.jpe`, `.jpeg`     |
        | TIFF Image         | `.tif`, `.tiff`             |
        | MPEG Video         | `.mpg`, `.mpeg`, `.mpe`     |
        | MSWORD             | `.doc`, `.docx`             |

        Currently, the maximum file size supported by e-RS is 5MB.

        ## Use case

        As an authenticated e-RS user

        I need to upload a referral letter or other clinical information file to e-RS

        So that I can associate the file with an existing referral.

        ## Important notes:

        This endpoint **only** performs the file upload. The uploaded file is **not** associated with a referral until the file has been associated with a referral, for example using [[HYPERLINK_A012]].
        
        The resulting URL within e-RS for the uploaded file is returned in the 'Location' header of the response.

        ## Related endpoints

        You can associate the uploaded file with a specific referral using [[HYPERLINK_A012]].

      summary: A020 - Upload file to document store
      operationId: a020-Upload-file-to-document-store
      parameters:
        - $ref: 'components/schemas/headers/request/BearerAuthorization.yaml'
        - $ref: 'components/schemas/headers/request/OdsCode.yaml'
        - $ref: 'components/schemas/headers/request/BusinessFunction.yaml'
        - $ref: 'components/schemas/headers/request/CorrelationID.yaml'
        - $ref: 'components/schemas/headers/request/ErsXapiMetaFilename.yaml'
        - $ref: 'components/schemas/headers/request/ErsXapiMetaIntendedUbrn.yaml'
      requestBody:
        required: true
        content:
          text/plain:
            schema:
              $ref: '#/components/schemas/StringBinarySchema'
            example: 'This is some example text.'
          text/html:
            schema:
              $ref: '#/components/schemas/StringBinarySchema'
          application/pdf:
            schema:
              $ref: '#/components/schemas/StringBinarySchema'
          text/xml:
            schema:
              $ref: '#/components/schemas/StringBinarySchema'
          text/rtf:
            schema:
              $ref: '#/components/schemas/StringBinarySchema'
          audio/basic:
            schema:
              $ref: '#/components/schemas/StringBinarySchema'
          audio/mpeg:
            schema:
              $ref: '#/components/schemas/StringBinarySchema'
          image/png:
            schema:
              $ref: '#/components/schemas/StringBinarySchema'
          image/gif:
            schema:
              $ref: '#/components/schemas/StringBinarySchema'
          image/jpeg:
            schema:
              $ref: '#/components/schemas/StringBinarySchema'
          image/tiff:
            schema:
              $ref: '#/components/schemas/StringBinarySchema'
          video/mpeg:
            schema:
              $ref: '#/components/schemas/StringBinarySchema'
          application/msword:
            schema:
              $ref: '#/components/schemas/StringBinarySchema'
          application/vnd.openxmlformats-officedocument.wordprocessingml.document:
            schema:
              $ref: '#/components/schemas/StringBinarySchema'
      responses:
        '201':
          $ref: 'components/schemas/responses/uploadFileToDocumentStore/201Response.yaml'
        '401':
          $ref: 'components/schemas/responses/Unauthorized.yaml'
        '403':
          $ref: 'components/schemas/responses/Forbidden.yaml'
        '422':
          $ref: 'components/schemas/responses/uploadFileToDocumentStore/422Response.yaml'
        '500':
          $ref: 'components/schemas/responses/InternalServerError.yaml'
components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
  schemas:
    StringBinarySchema:
      type: string
      format: binary
     
